<!DOCTYPE html>
<html>
<head>
    <title>AR.js with A-Frame Zoom & Hop</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    
    <style>
        /* AR表示のため、Webカメラの映像をフルスクリーンで表示するためのスタイル */
        .a-canvas {
            margin: 0;
            overflow: hidden;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body style="margin: 0; overflow: hidden;">
    
    <a-scene 
        embedded 
        arjs='sourceType: webcam; detectionMode: mono; cameraParametersUrl: https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/camera-parameters/camera_para.dat;'>
        
        <a-marker preset='hiro'>
            <a-entity>
                <a-plane 
                    id="character" 
                    src="character-image.png" position="0 0.02 0"         rotation="-90 0 0"          width="1" 
                    height="1"
                    cursor-listener> 
                    
                    <a-animation 
                        id="zoom-in-anim"
                        attribute="scale" 
                        to="1.5 1.5 1.5" 
                        dur="500"                    
                        easing="easeOutQuad"
                        begin="click"           end="zoom-in-complete"      
                        fill="forwards">
                    </a-animation>
                    
                    <a-animation 
                        id="hop-anim"
                        attribute="position" 
                        to="0 0.5 0"                dur="200"                    
                        direction="alternate"        
                        repeat="2"                   
                        easing="easeInOutQuad"
                        begin="zoom-in-complete"     
                        end="hop-complete">
                    </a-animation>
                    
                    <a-animation 
                        id="zoom-out-anim"
                        attribute="scale" 
                        to="1 1 1"                    
                        dur="300"
                        easing="easeOutQuad"
                        begin="hop-complete"          
                        fill="forwards">
                    </a-animation>
                </a-plane>
            </a-entity>
        </a-marker>
        
        <a-entity camera></a-entity>
    </a-scene>
    
    <script>
        // アニメーションのシーケンスを制御するJavaScript (元のコードと同じロジック)
        document.addEventListener('DOMContentLoaded', function () {
            const character = document.getElementById('character');
            
            // スケールアニメーションの完了イベントハンドラを設定
            character.addEventListener('animationcomplete', function(event) {
                if (event.detail.name === 'animation__zoom-in-anim') {
                    // ズームイン完了後、ホップアニメーションを開始
                    character.emit('zoom-in-complete');
                } else if (event.detail.name === 'animation__hop-anim') {
                    // ホップ完了後、ズームアウトアニメーションを開始
                    character.emit('hop-complete');
                }
            });
        });
    </script>
</body>
</html>
